"use strict";(self.webpackChunkgatsby_apollo_starter=self.webpackChunkgatsby_apollo_starter||[]).push([[885],{7955:function(t,e,n){n.d(e,{a:function(){return r}});var i=n(5285);function r(t,e){return(0,i.r)(t,e,!1)}},8034:function(t,e,n){n.d(e,{Z:function(){return x}});var i=n(7294),r=n(8037),s=n(8945),o=(n(2066),n(5263)),u=function(t){function e(e){var n=e.options,i=e.context,r=e.setResult,s=t.call(this,n,i)||this;return s.currentObservable={},s.setResult=r,s.initialize(n),s}return(0,s.ZT)(e,t),e.prototype.execute=function(t){if(!0===this.getOptions().skip)return this.cleanup(),{loading:!1,error:void 0,data:void 0,variables:this.getOptions().variables};var e=t;this.refreshClient().isNew&&(e=this.getLoadingResult());var n=this.getOptions().shouldResubscribe;return"function"==typeof n&&(n=!!n(this.getOptions())),!1!==n&&this.previousOptions&&Object.keys(this.previousOptions).length>0&&(this.previousOptions.subscription!==this.getOptions().subscription||!(0,o.D)(this.previousOptions.variables,this.getOptions().variables)||this.previousOptions.skip!==this.getOptions().skip)&&(this.cleanup(),e=this.getLoadingResult()),this.initialize(this.getOptions()),this.startSubscription(),this.previousOptions=this.getOptions(),(0,s.pi)((0,s.pi)({},e),{variables:this.getOptions().variables})},e.prototype.afterExecute=function(){this.isMounted=!0},e.prototype.cleanup=function(){this.endSubscription(),delete this.currentObservable.query},e.prototype.initialize=function(t){this.currentObservable.query||!0===this.getOptions().skip||(this.currentObservable.query=this.refreshClient().client.subscribe({query:t.subscription,variables:t.variables,fetchPolicy:t.fetchPolicy,context:t.context}))},e.prototype.startSubscription=function(){this.currentObservable.subscription||(this.currentObservable.subscription=this.currentObservable.query.subscribe({next:this.updateCurrentData.bind(this),error:this.updateError.bind(this),complete:this.completeSubscription.bind(this)}))},e.prototype.getLoadingResult=function(){return{loading:!0,error:void 0,data:void 0}},e.prototype.updateResult=function(t){this.isMounted&&this.setResult(t)},e.prototype.updateCurrentData=function(t){var e=this.getOptions().onSubscriptionData;this.updateResult({data:t.data,loading:!1,error:void 0}),e&&e({client:this.refreshClient().client,subscriptionData:t})},e.prototype.updateError=function(t){this.updateResult({error:t,loading:!1})},e.prototype.completeSubscription=function(){var t=this;Promise.resolve().then((function(){var e=t.getOptions().onSubscriptionComplete;e&&e(),t.endSubscription()}))},e.prototype.endSubscription=function(){this.currentObservable.subscription&&(this.currentObservable.subscription.unsubscribe(),delete this.currentObservable.subscription)},e}(n(1122).V),a=n(8286),c=n(2441);var l,p=n(3153),b=n(5444),h=n(4767),d=n(8937),v=n(6131),g=n(9335),f=n(737),m=n(9355),O=n(1880),E=(0,n(5185).ZP)(l||(l=(0,O.Z)(["\n  subscription roomUpdated($slug: String!){\n    roomUpdated(slug: $slug){\n      id\n      host\n      slug\n      settings {\n        timeLimit\n        maxPlayers\n        rounds\n      }\n    }\n  }\n"]))),y=function(t){var e=t.room;return i.createElement(i.Fragment,null,(null==e?void 0:e.settings)&&Object.keys(e.settings).map((function(t){return i.createElement(v.ZT,{key:t,variant:"p"},t,": ",null==e?void 0:e.settings[t])})))},x=(0,f.z)((function(t){var e,n,o,l,f,O,x,k,C,R,S=t.user,Z=t.room,D=(0,p.D)(m.Y,{onCompleted:function(t){(0,b.navigate)("/")},onError:function(t){h.Z.danger(g.$.extractGQLErrorMessage(t))}}),_=D[0],z=D[1].loading,L=(e=E,n={variables:{slug:"EYT1o"},onSubscriptionData:function(t){var e=t.subscriptionData;console.log(e.data)}},o=(0,i.useReducer)((function(t){return t+1}),0)[1],l=(0,i.useContext)((0,a.K)()),f=n?(0,s.pi)((0,s.pi)({},n),{subscription:e}):{subscription:e},O=(0,i.useState)({loading:!f.skip,error:void 0,data:void 0}),x=O[0],k=O[1],(C=(0,i.useRef)()).current||(C.current=new u({options:f,context:l,setResult:k})),(R=C.current).setOptions(f,!0),R.context=l,__DEV__&&(0,c.j)(o),(0,i.useEffect)((function(){return R.afterExecute()})),(0,i.useEffect)((function(){return function(){R.cleanup(),C.current=void 0}}),[]),R.execute(x));L.data,L.loading;return i.createElement(d.r,null,i.createElement(v.ZT,{variant:"h3"},"Wait here for host to start game..."),i.createElement(y,{room:Z}),i.createElement(v.J3,null),i.createElement(r.ZP,{to:"/"},i.createElement(v.zx,{className:"mb-4",outline:!0},"Back to home")),S.uid===(null==Z?void 0:Z.host)?i.createElement(v.zx,{className:"mb-4",color:"Crimson",outline:!0,onClick:function(){_({variables:{host:S.uid}})},loading:z},"End game"):null)}))},7548:function(t,e,n){n.r(e);var i=n(5245),r=n(7294),s=n(5444),o=n(7955),u=n(7487),a=n(8034),c=n(9482),l=n(737),p=n(3597),b=["user","signedIn","signInLoading"],h=function(t){var e=t.room;return r.createElement(r.Fragment,null,r.createElement(u.Z,{title:"Game"}),r.createElement(a.Z,{room:e}))};e.default=(0,l.z)((function(t){t.user,t.signedIn,t.signInLoading;var e=(0,i.Z)(t,b);""===e["*"]&&(0,s.navigate)("/404");var n=(0,o.a)(p.WS,{variables:{slug:e["*"]},onCompleted:function(t){0===t.rooms.length&&(0,s.navigate)("/404")},onError:function(t){console.error(t)}}),u=n.data;n.loading;return r.createElement(c.Ar,{title:"Game",content:r.createElement(h,{room:(null==u?void 0:u.rooms.length)>0?u.rooms[0]:null})})}))}}]);
//# sourceMappingURL=component---src-pages-play-js-64c26287bdb5c8997399.js.map