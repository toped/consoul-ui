"use strict";(self.webpackChunkgatsby_apollo_starter=self.webpackChunkgatsby_apollo_starter||[]).push([[329],{7674:function(e,t,n){var o=n(2982),l=n(7294),r=n(8037),a=n(3919),i=n(5444),s=n(4767),u=n(8937),c=n(259),m=n(9335),d=n(9428),b=n(9355),g=function(e){var t=e.room;return l.createElement("div",{className:"my-4 text-center"},(null==t?void 0:t.settings)&&Object.keys(null==t?void 0:t.settings).map((function(e){return l.createElement(c.ZT,{key:e,variant:"p"},e,": ",null==t?void 0:t.settings[e])})))};t.Z=(0,d.z)((function(e){var t=e.user,n=e.room,d=e.subscribeToRoomUpdates,v=e.subscribeToDeletion;(0,l.useEffect)((function(){null==t||!t.uid||null!=n&&n.players.map((function(e){return e.uid})).includes(t.uid)||(null==n?void 0:n.players.length)<(null==n?void 0:n.settings.maxPlayers)&&p({displayName:t.displayName,email:t.email,photoURL:t.photoURL,phoneNumber:t.phoneNumber,uid:t.uid}),null!==t&&Object.keys(t).length||console.log("allow play as guest")}),[t]),(0,l.useEffect)((function(){console.log("lobby subscribing to room updates"),d(),v()}),[]);var f=(0,a.D)(b.Db,{onError:function(e){s.Z.danger(m.$.extractGQLErrorMessage(e))}})[0],p=function(e){console.log("mutating room from lobby"),f({variables:{room:Object.assign({},n,{players:[].concat((0,o.Z)(null==n?void 0:n.players),[e])})}})},E=(0,a.D)(b.Y6,{onCompleted:function(e){(0,i.navigate)("/")},onError:function(e){s.Z.danger(m.$.extractGQLErrorMessage(e))}}),y=E[0],h=E[1].loading;return l.createElement(u.r,null,l.createElement(c.ZT,{variant:"h3",weight:"bold",className:"m-0"},"Wait here for others to join..."),l.createElement(c.ZT,{variant:"h5"},"The host will start the game soon."),l.createElement(c.J3,{players:null==n?void 0:n.players}),l.createElement(g,{room:n}),l.createElement(r.ZP,{to:"/"},l.createElement(c.zx,{className:"mb-4",outline:!0},"Back to home")),(null==t?void 0:t.uid)===(null==n?void 0:n.host)?l.createElement(c.zx,{className:"mb-4",color:"MediumSeaGreen",outline:!0,onClick:function(){return console.log("mutating room from lobby"),void f({variables:{room:Object.assign({},n,{started:!0})}})}},"Start Game"):null,(null==t?void 0:t.uid)===(null==n?void 0:n.host)?l.createElement(c.zx,{className:"mb-4",color:"Crimson",outline:!0,onClick:function(){y({variables:{host:t.uid}})},loading:h},"End game"):l.createElement(c.zx,{className:"mb-4",color:"Crimson",outline:!0,onClick:function(){return e={uid:null==t?void 0:t.uid},console.log("mutating room from lobby"),void f({variables:{room:Object.assign({},n,{players:(0,o.Z)(null==n?void 0:n.players.filter((function(t){return t.uid!==e.uid})))})}});var e},loading:h},"Leave game"))}))},7320:function(e,t,n){n.r(t);var o=n(7294),l=n(7487),r=n(7674),a=n(2117),i=function(){return o.createElement(o.Fragment,null,o.createElement(l.Z,{title:"Join Game"}),o.createElement(r.Z,null))};t.default=function(){return o.createElement(a.Ar,{title:"Join Game",content:o.createElement(i,null)})}}}]);
//# sourceMappingURL=component---src-pages-lobby-js-cb20091eae03c624672d.js.map